<!doctype html>
<html lang="en">

<head>
	<title>管理员页面</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
	<!-- VENDOR CSS -->
	<link rel="stylesheet" href="./assets/vendor/bootstrap/css/bootstrap.min.css">
	<!--<link rel="stylesheet" href="./assets/vendor/font-awesome/css/font-awesome.min.css">-->
	<link rel="stylesheet" href="assets/vendor/linearicons/style.css">
	<link rel="stylesheet" href="assets/vendor/chartist/css/chartist-custom.css">
	<!-- MAIN CSS -->
	<link rel="stylesheet" href="assets/css/main.css">
	<!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
	<!--<link rel="stylesheet" href="assets/css/demo.css">-->
	<!-- GOOGLE FONTS -->
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
	<!-- ICONS -->
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
	<link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">
	<style>
		html body {
			margin:0px;
			padding:0px;

		}
		h2 {
			text-align:left;
			line-height:80px;
		}

	</style>
</head>

<body>
	<!-- WRAPPER -->
<div id="wrapper">
		<!-- NAVBAR -->
		<nav class="navbar navbar-default navbar-fixed-top">
			<div class="brand">
				<a href="#"><img src="assets/img/logo-dark.png" alt="Klorofil Logo" class="img-responsive logo"></a>			</div>
			<div class="container-fluid">

				<form class="navbar-form navbar-left">
				</form>

			</div>
		</nav>
		<!-- END NAVBAR -->
		<!-- LEFT SIDEBAR -->
		<div id="sidebar-nav" class="sidebar">
			<div class="sidebar-scroll">
				<nav>
					<ul class="nav">
						<li><a href="index.html" class="active"><i class="lnr lnr-home"></i> <span>Dashboard</span></a></li>
						<li><a href="elements.html" class=""><i class="lnr lnr-code"></i> <span>Elements</span></a></li>
						<li><a href="charts.html" class=""><i class="lnr lnr-chart-bars"></i> <span>Charts</span></a></li>
						<li><a href="panels.html" class=""><i class="lnr lnr-cog"></i> <span>Panels</span></a></li>
						<li><a href="notifications.html" class=""><i class="lnr lnr-alarm"></i> <span>Notifications</span></a></li>
						<li>
							<a href="#subPages" data-toggle="collapse" class="collapsed"><i class="lnr lnr-file-empty"></i> <span>Pages</span> <i class="icon-submenu lnr lnr-chevron-left"></i></a>
							<div id="subPages" class="collapse ">
								<ul class="nav">
									<li><a href="page-profile.html" class="">Profile</a></li>
									<li><a href="page-login.html" class="">Login</a></li>
									<li><a href="page-lockscreen.html" class="">Lockscreen</a></li>
								</ul>
							</div>
						</li>
						<li><a href="tables.html" class=""><i class="lnr lnr-dice"></i> <span>Tables</span></a></li>
						<li><a href="typography.html" class=""><i class="lnr lnr-text-format"></i> <span>Typography</span></a></li>
						<li><a href="icons.html" class=""><i class="lnr lnr-linearicons"></i> <span>Icons</span></a></li>
					</ul>
				</nav>
			</div>
		</div>
		<!-- END LEFT SIDEBAR -->
		<!-- MAIN -->
	<div class="main" >
		<div class="	" style="height:110px;background-color:#cde2e2;">
			<div class="col-md-2" >
				<h2 >选择班级:</h2>
			</div>

			<div class="col-md-2 col-sm-6 col-xs-12" style="height:100px"><a href="javascript:void(0)" onclick="changeClass(this)"><h2 >12</h2></a></div>
			<div class="col-md-2 col-sm-6 col-xs-12" style="height:100px"><a href="javascript:void(0)" onclick="changeClass(this)"><h2 >21</h2></a></div>
			<div class="col-md-2 col-sm-6 col-xs-12" style="height:100px"><a href="javascript:void(0)" onclick="changeClass(this)"><h2 >19</h2></a></div>
			<div class="col-md-2 col-sm-6 col-xs-12" style="height:100px"><a href="javascript:void(0)" onclick="changeClass(this)"><h2 >1518011</h2></a></div>
			<div class="col-md-2 col-sm-6 col-xs-12" style="height:100px"><a href="javascript:void(0)" onclick="changeClass(this)"><h2 >1518028</h2></a></div>
		</div>

		<!--添加人员名单-->
		<div style="margin-top:0px;background-color:white" id="classList" class='col-md-12 col-sm-12 col-xs-12' style='padding:30px; position: static' >
                <h2 style='display:inline;'> <img src="./assets/img/群众.png" height="50" width="50"/>&emsp;<span id="class"style="font-size:35px;">12</span>班人员名单：</h2>
				<div>
					<table class="table table-striped table-hover">
						<thead>
							<tr>
								<th>姓名</th>
								<th>姓名</th>
								<th>姓名</th>
								<th>姓名</th>
								<th>姓名</th>
								<th>姓名</th>
								<th>姓名</th>
							</tr>
						</thead>
						<tbody id='all-list'>
						</tbody>
					</table>
				</div>
			<!--添加人员名单结束-->
		</div>
		<div style="margin-top:0px;background-color:white;display:none " id="clone" class='col-md-12 col-sm-12 col-xs-12' style='padding:30px; position: static' >
                <h1 style='text-align:center'>学生签到信息</h1>
				<div>
					<table class="table table-striped table-hover">
						<thead>
							<tr>
								<th>序号</th>
								<th>姓名</th>
								<th>学号</th>
								<th>日期</th>
								<th>连接时间</th>
								<th>断开时间</th>
								<th>连接时长</th>
								<th>备注</th>
							</tr>
						</thead>
						<tbody id='message-list' >
						</tbody>
					</table>
				</div>
			<!--添加人员名单结束-->
		</div>



	</div>
	<!-- END WRAPPER -->
	<!-- Javascript -->
	<script src="./assets/vendor/jquery/jquery.min.js"></script>
	<script src="./assets/vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="./assets/vendor/jquery-slimscroll/jquery.slimscroll.min.js"></script>
	<script src="./assets/vendor/jquery.easy-pie-chart/jquery.easypiechart.min.js"></script>
	<script src="./assets/vendor/chartist/js/chartist.min.js"></script>
	<script src="./assets/scripts/klorofil-common.js"></script>
	<script src="./assets/js/jquery-3.1.1.min.js"></script>
	
	
	
	
	<script>
	var data1;
	var data2;
	var object_js;
    var s=new Array();
    s.push('btn-danger');
    s.push('btn-success');
	var messageList=document.getElementById('message-list');
    var allList=document.getElementById('all-list');
    var object_no;
    var noList=document.getElementById('no-list');
	var student_name;
	
	class_number=12;
	 function changeClass(which){
	 //alert("123");
	 if(which!=null){
		class_number = $(which).text();
		//document.getElementById("classList").style.visibility="visible";
		$("#classList").show();
		$("#clone").css("display","none");
		var span=document.getElementById("class");
		span.innerHTML = class_number;
		//if(!data1){
		//	data1 = '1';
		//}
			
		//data1=setInterval('changeClass()',2000);
		//clearInterval(data2);
	 }
	 
        $.ajax({
            url: 'http://192.168.1.100:9000/main_page/front/data', //在这里提填写你的地址
            async: false,
            dataType: 'jsonp',
			data:{'class_number':class_number},
			type:'get',
			jsonp:"callback", 
			crossDomain: true,
			jsonpCallback:"callback",
            success: function (json_str) {
				object_js = json_str;
				
				//console.log(object_js.郭嘉城);
				//document.write(object_js);
				showAllList();
            }

        });
    }
	
	
	function showAllList(){
        $('#all-list tr').remove();
        var size=0,key;
        var statuses=new Array();
        var names=new Array();
        for(key in object_js){
            if(object_js.hasOwnProperty(key)){
                names.push(key);
                statuses.push(object_js[key]);
                size++;
            }
        }
        var i=0;
        for(i=0;i<size;){
            var tr=document.createElement('tr');
            do{
                if(i>=size){
                    break;
                }
                var td=document.createElement('td');
                var btn=document.createElement('a');
                btn.innerHTML=names[i];
				btn.setAttribute('onclick','student_message(this)');
				//tr.setAttribute('value','message')
				//btn.setAttribute('target','_blank')
                $(btn).attr('href','#');
                $(btn).addClass('btn');
                $(btn).css('width','100%');
                $(btn).addClass(s[statuses[i]]);
                td.appendChild(btn);
                tr.appendChild(td);
                i++;
            }while(i%7!=0);
            allList.appendChild(tr);
        }
    }
	function student_message(which){
	
	student_name=which.innerHTML;
	//var div1=document.getElementById("classList");
	//div1.innerHTML="";
	//a=$(this).text();
	$("#classList").hide();
	$("#clone").css("display","");
	//clearInterval(data1);
	//clearInterval(data2);
	//data2=setInterval('changeMessage()',600);
	changeMessage();
	}
	
	
	function changeMessage(){
	
	 
        $.ajax({
            url: 'http://192.168.1.109:9000/admin/list', //在这里提填写你的地址
            async: false,
            dataType: 'jsonp',
			data:{'student_name':student_name},
			type:'get',
			jsonp:"callback", 
			crossDomain: true,
			jsonpCallback:"callback",
            success: function (json_str) {
				object_js = json_str;
				
				//console.log(object_js.郭嘉城);
				//document.write(object_js);
				showMessageList();
            }

        });
    }
	function createInfo(text,tr){
	
		var td=document.createElement('td');
		var btn=document.createElement('a');
		$(td).css("padding","0px");
		$(td).css("margin-top","-2px");
		btn.innerHTML=text;
		$(btn).attr('href','#');
		$(btn).addClass('btn');
		$(btn).css('width','100%');
		$(btn).css('height','100%');
		$(btn).css('background-color','white');
		$(btn).css('color','black');
		$(btn).css('border-color','black');
		$(btn).css('border-radius','0');
{#		$(btn).css('text-overflow','ellipsis');#}
{#		$(btn).css('white-space','nowrap');#}
{#		$(btn).css('overflow','hidden');#}
		var maxNum=$(btn).html();
            if(maxNum.length>15){
                $(btn).html(maxNum.substr(0,15)+"...")
        }

		btn.setAttribute('title',text);
		
		
		
		td.appendChild(btn);
		tr.appendChild(td);
		messageList.appendChild(tr);
	}
	
	function showMessageList(){
        $('#message-list tr').remove();
        
		var students_list = object_js.list;
		//console.log(list);
		for(var i = 0; i < students_list.length; i++){
			student = students_list[i];
			var info_list = new Array();
			var tr=document.createElement('tr');
			var student_name = student['student_name'];
			var student_id = student['student_id'];
			var number = student['number'];
			var date = student['date'];
			var time_start = student['time_start'];
			var time_end = student['time_end'];
			var time = student['time'];
			var remarks = student['remarks'];
			createInfo(number,tr);
			createInfo(student_name,tr);
			createInfo(student_id,tr);
			createInfo(date,tr);
			createInfo(time_start,tr);
			createInfo(time_end,tr);
			createInfo(time,tr);
			createInfo(remarks,tr);
			
			messageList.appendChild(tr);
		}
		
    }
    
	//!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	window.onload=function(){
		changeClass();
		data2=setInterval('changeClass()',2000);//6000是间隔时间  单位为毫秒 6000就是一分钟
	} 


	
	
	</script>

</body>
</html>
